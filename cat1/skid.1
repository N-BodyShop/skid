


SKID(1.2)                     SKID                      SKID(1.2)



NAME
     skid - Find gravitationally bound groups in  N-body  simula-
     tions.

SYNOPSIS
     skid -tau <fLinkLength> [OPTIONAL ARGUMENTS]
               reads TIPSY BINARY input file from stdin
     COSMOLOGY and UNITS arguments:
          [-z <fRedShift>] [-O <fOmega>]
          [-G <fGravConst>] [-H <fHubble>]
     GROUP FINDING arguments (see man page!):
          [-s <nSmooth>] [-d <fMinDensity>] [-t <fMaxTemp>]
          [-cvg <fConvergeRadius>] [-scoop <fScoopRadius>]
          [-m <nMinMembers>] [-nu] [-unbind <GroupFile>]
     GRAVITATIONAL SOFTENING arguments:
          [-spline] [-plummer] [-e <fSoft>]
     PERIODIC BOX specification:
          [-p <xyzPeriod>]
          [-px <xPeriod>] [-py <yPeriod>] [-pz <zPeriod>]
          [-c <xyzCenter>]
          [-cx <xCenter>] [-cy <yCenter>] [-cz <zCenter>]
     OUTPUT arguments:
          [-o <Output Name>] [-ray] [-den]


OPTIONS
     -tau <fLinkLength>: No Default fLinkLength value!
     This parameter should be set to the length scale of interest
     for  the groups. For example in a gas simulation it might be
     set to the rough size  of  galaxies.  It  sets  the  linking
     length  which  the  friends-of-friends  stage  uses  to link
     together  the  converged  particles.  It  also  defines  the
     default  values for the -cfg and -scoop arguments.  For more
     information of this parameter's signifigance see the discus-
     sion below.

     [-z <fRedShift>]: Default fRedShift = 0.0
     The redshift of the input file. This is  used  to  determine
     physical  coordinates from comoving ones. The default of 0.0
     specifies that the input file is the state of the simulation
     at our (the current) epoch.

     [-O <fOmega>]: Default fOmega = 1.0
     This sets the Omega parameter for the  simulation  in  ques-
     tion. The default value of 1.0 specifies a flat universe.

     [-G <fGravConst>]: Default fGravConst = 1.0
     The relevant gravitational constant  in  the  units  of  the
     simulation.  Most  N-body  simulations  have their units set
     such that this constant is 1.0.

     [-H <fHubble>]: Default fHubble = 0.0



Stadel Release 1.2  Last change: Jan 18, 1995                   1






SKID(1.2)                     SKID                      SKID(1.2)



     Sets the Hubble constant for the simulation. If the  simula-
     tion was not performed in comoving coordinates then this can
     be left at zero. Note that this must be set in the units  of
     the simulation.

     [-s <nSmooth>]: Default nSmooth = 64
     Specifies the number of neighbors to smooth over when  find-
     ing densities.

     [-d <fMinDensity>]: Default fMinDensity = 0.0
     This sets the minimum density for dark matter or gas  parti-
     cles which are considered for grouping.

     [-t <fMaxTemperature>]: Default fMaxTemperature = HUGE
     This sets the maximum temperature for  gas  particles  which
     are considered for grouping.

     [-cvg <fConvergeRadius>]:
     Default fConvergeRadius = fLinkLength / 2.0
     This parameter set the resolution of the converging process.
     Once particles have converged into balls of this radius, the
     group assignments  are  made  using  the  friends-of-friends
     algorithm.  It  also  sets  a minimum scattering radius when
     calculating the density gradients. See description below.

     [-scoop <fScoopRadius>]:
     Default fScoopRadius = 2.0 * fLinkLength
     This parameter specifies how much of the "environment" about
     a  group is to be considered when identifying unbound parti-
     cles.  All the mass within this radius  contributes  to  the
     potential energy of particles within a group. This parameter
     is ignored in the dark matter only case.

     [-m <nMinMembers>]: Default nMinMembers = 8
     This argument allows the user to specify  what  the  minimum
     number  of  members  (particles)  per  group  should be. All
     groups with less than this value will be dicarded.

     [-nu]: Disables Unbinding (No Unbinding).
     When this flag is specified, SKID will bypass the  unbinding
     procedure but still output all the normal group information.
     This is useful if special unbinding methods are required for
     a  simulation  or  if unbinding is completely undesired. The
     user can write a special unbinding program which would  read
     the  skid.grp  file  or  use the -unbind argument at a later
     time.

     [-unbind <GroupFile>]:
     When a group file is specified  here,  SKID  will  take  the
     group  assignments  in this file and proceed directly to the
     unbinding stage. This argument is useful when one  wants  to
     experiment  with different unbinding parameters for the same



Stadel Release 1.2  Last change: Jan 18, 1995                   2






SKID(1.2)                     SKID                      SKID(1.2)



     group assignments.  Also if  the  unbind  part  of  SKID  is
     desired  for  a  different  grouping algorithm such as plain
     friends-of-friends.

     [-spline]: This is the default.
     Use a cubic spline softened gravitational  interaction  when
     calculating the binding energies of particles in each group.
     See (A1) and (A2) of TREESPH: A UNIFICATION OF SPH WITH  THE
     HIERARCHICAL  TREE  METHOD  by Lars Hernquist and Neal Katz,
     APJ Supplement Series 70:416-446, 1989.

     [-plummer]:
     Use plummer softened gravitational interactions when  calcu-
     lating  the  binding  energies  of  particles in each group.
     Note: plummer softened potentials are quite a  bit  "softer"
     than  the  cubic  spline  potentials  for the same softening
     radius.

     [-e <fSoft>]:
     By default the softening radii of particles are  taken  from
     the TIPSY BINARY input file.
     This sets the softening radii of all particles to  the  same
     value,  fSoft.  This softening is then used when calculating
     the binding energies of particles in each group.

     [-p <xyzPeriod>]:
     Default non-periodic in x,y and z dimensions
     Specifies that SKID take into  account  periodicity  in  all
     three dimension given by the period <xyzPeriod>. This can be
     used in place of the above as a shorthand.

     [-px <xPeriod>]: Default non-periodic in x dimension
     Specifies that SKID take into  account  periodicity  in  the
     x-dimension given by the period <xPeriod>.

     [-py <yPeriod>] [-pz <zPeriod>]: As above.

     [-c <xyzCenter>]:
     Default box center is 0.0 in x,y and z dimensions
     For periodic simulations specifies the center of the box  in
     all three dimensions. This is a shorthand to the above.

     [-cx <xCenter>]: Default box center is 0.0 in x dimension
     Specifies the center of the periodic  box  when  SKID  takes
     into  account periodicity in the x-dimension. This arguement
     can be ignored for a non-periodic simulation.

     [-cy <yCenter>] [-cz <zCenter>]: As above.

     [-o <Output Name>]: Default Output Name = "skid".
     This allows the user to specify an alternate  name  for  the
     output  files. For example, if the user specifies -o sim5 on



Stadel Release 1.2  Last change: Jan 18, 1995                   3






SKID(1.2)                     SKID                      SKID(1.2)



     the command line, then SKID  will  by  default  produce  the
     files sim5.grp and sim5.gtp (and if requested sim5.ray).

     [-ray]: Causes the skid.ray output file to be produced.
     By default skid does not produce the skid.ray  output  file.
     With  this argument present it will produce this (tipsy vec-
     tor format) file.

     [-den]: Causes the skid.den output file to be produced.
     This option outputs the densities  of  the  particles  which
     SKID  uses  for  its  initial density cut. Note: this is the
     same as the density output by SMOOTH for the same nSmooth.


DESCRIPTION
     SKID finds gravitationally bound groups  in  N-body  simula-
     tions. The general procedure is first to decide which parti-
     cles should be grouped, these are called the "moving" parti-
     cles.   The  particles  considered  may be of a certain type
     (there are three types in the tipsy format, dark matter, gas
     and  stars). They may have to satisfy a minimum density cri-
     terion and may also (in the case of gas) need to  satisfy  a
     maximum  temperature  criterion. This choice of particles is
     affected by the type of input file and  the  users  settings
     for  the  minimum density and maximum temperature. There are
     seven possible types of tipsy input files and  here  is  how
     each is handled.

     Dark matter only: density and density gradients  are  calcu-
     lated  from  all the particles (dark), and the moving parti-
     cles are those meeting the minimum density criterion.

     Gas only: density and density gradients are calculated  from
     all  the particles (gas), and the moving particles are those
     meeting both the minimum  density  and  maximum  temperature
     criteria.

     Stars only: density gradients are calculated  from  all  the
     particles (stars), and all the particles are moved.

     Gas and dark matter: density and density gradients are  cal-
     culated  from  the gas particles only, and the moving parti-
     cles are the gas particles which meet the density  and  tem-
     perature criteria.

     Stars and gas: density gradients  are  calculated  from  the
     star  particles  only,  and the moving particles are all the
     star particles.

     Stars and dark matter: Same as stars and gas case.

     Stars and gas and dark matter: density and density gradients



Stadel Release 1.2  Last change: Jan 18, 1995                   4






SKID(1.2)                     SKID                      SKID(1.2)



     are  calculated  from all the star particles and all the gas
     particles.  The moving particles are then the gas  particles
     meeting  the  density  and  temperature criteria and all the
     star particles.

     Once the moving particles have  been  found  they  are  then
     moved  along the initial density gradients toward regions of
     higher density.  The particles are  successively  stepped  a
     distance  of  fConvergeRadius/2.0  in this manner until they
     stay within a distance  of  fConvergeRadius  over  5  steps.
     This means that they are oscillating in a local high density
     region.  We then group all the particles in each  high  den-
     sity  region  together  using  the friends-of-friends method
     with a linking length of fLinkLength.  Note that  this  also
     links  together  high density regions seperated by less than
     fLinkLength. Once all particles are localized in  this  way,
     we  proceed  to "squish" them together even more to find the
     high density center. Lastly we discard groups with less than
     nMinMembers number of particles.

     The next stage (if the user has not  specified  -nu)  is  to
     remove  particles from a group which are not gravitationally
     bound to it. We call this phase unbinding  and  the  initial
     positions  are  considered  here,  not  the moved positions.
     There are cases for unbinding, one for dark matter  only  or
     star particle only inputs (case I unbinding) and one for the
     other input types (case II unbinding).

     Case I unbinding:

     1. Calculate the potential energies of all the particles  in
     the group taking into account the redshift of the simulation
     to get physical distances (redshift zero applies also  to  a
     simulation in physical coordinates).

     2. The center of mass and center of mass  velocity  for  the
     group  is found. The velocity relative to the center of mass
     velocity if found for all the particles in the  group.  This
     relative  velocity  is  converted  to a physical velocity by
     taking into account  the  redshift  and  adding  a  term  to
     include  the Hubble flow. For a simulation in physical coor-
     dinates fHubble  must  be  0.0.   (Note  that  this  is  the
     default!)  From  this the kinetic energy with respect to the
     center of mass is found for all particles in the group.

     3. The least bound particle is found. If  this  particle  is
     bound  then  all  particles  are  bound and we have finished
     unbinding for this group. Otherwise we must remove  it  from
     the  group,  adjusting  the  potential  energies and kinetic
     energies (the center of mass changes) of the remaining  par-
     ticles and return to step 3.




Stadel Release 1.2  Last change: Jan 18, 1995                   5






SKID(1.2)                     SKID                      SKID(1.2)



     Case II unbinding:

     Here we include some  of  the  group's  environment  to  the
     potential.   For example a galaxy depends on its dark matter
     halo in order to stay together.

     1. Calculate the potential energies as per case I, step 1.

     1a. Include the potential contribution  of  all  non-grouped
     mass  within  a  2*fLinkLength  ball about the center of the
     high density region of the group. In otherwords we  want  to
     include some of the mass about the density maximum.

     2. Calculate the kinetic energies as per case I, step 2.

     3. The least bound particle is found. If  this  particle  is
     bound  then  again we are finished with the group. Otherwise
     we remove it from the group, adjusting the kinetic  energies
     as in case I. Then we go back to step 3. Note that this time
     we do not subtract the potential energy contribution of this
     particle  from  the others in the group. The potential ener-
     gies remain fixed as any  removed  particle  is  still  con-
     sidered to be part of the groups environment.

     After unbinding we check once more that all groups  have  at
     least nMinMembers number of particles. We discard those that
     don't and output the group information.


OUTPUT FILES
     Skid produces three different output  files,  by  default  a
     skid.grp  file,  and  a  skid.gtp  file.  Optionally  also a
     skid.ray file.

     skid.grp: This ASCII file is in TIPSY ARRAY format and  con-
     tains  the  group number to which each particle in the input
     file belongs. Group number zero means this particle was  not
     grouped  (could  have  been removed by unbinding). This file
     can be read in by tipsy or any other analysis tool  able  to
     read this format.

     skid.gtp: This file is in TIPSY BINARY format (same  as  the
     input file) and contains one star particle to represent each
     group that skid finds. Each particle in this file has as its
     position,  the  position  of the group's density maximum. As
     its velocity, the center of mass velocity of the group. Each
     star particle's mass is the mass of the entire group and the
     star_particle.eps field contains  the  radial  size  of  the
     group.  (The  time stamp of the input file is also stored in
     each star_particle.tform field.) This file can also be  read
     in by tipsy or any tool accepting TIPSY BINARY format.




Stadel Release 1.2  Last change: Jan 18, 1995                   6






SKID(1.2)                     SKID                      SKID(1.2)



     skid.ray: This ASCII file is in TIPSY VECTOR format and con-
     tains  a  vector  pointing from the initial position of each
     particle to the localized (moved and squished)  position  of
     that  particle. For particles not moved the vector stored is
     null. This file can be read in by tipsy and used to  analyse
     the actions of skid.

     skid.den: This ASCII file is in TIPSY ARRAY format and  con-
     tains  the density of each particle considered for grouping.
     Particles not considered for grouping have their density set
     to 0.


EXAMPLES
     > skid -tau 9e-4 -H 2.8944 -d 170 -p 1 -o dark < dark.bin

     This example  groups  dark  matter  particles  in  the  file
     dark.bin.  The  simulation is periodic with period length of
     1.0 in each dimension and box centered on (0,0,0).  The Hub-
     ble  constant  in  system  units  in  this  case  is  2.8944
     (sqrt(8*Pi/3)) and  the  redshift  defaults  to  0  (current
     epoch).  The  density  cut is made at a density of 170 (mean
     density is  1  in  these  units).  The  files  dark.grp  and
     dark.gtp are produced.

     > skid -tau 9e-4 -H 2.8944 -d 170 -t  30000  -z  1  -p  1  <
     all.bin

     Here we suppose that dark matter, gas and stars are  in  the
     input file. A cut in the gas is made at a density minimum of
     170 and temperature maximum of 30000 (cold  dense  gas)  and
     groups  of  this  gas and all the stars are formed at a red-
     shift of 1. The files skid.grp and skid.gtp are created.

     > skid -tau 0.5 -d 100 -m 8 -ray -nu -o phys < phys.bin

     Here skid processes a dark matter file in  physical  coordi-
     nates  which  is non-periodic. It makes a density cut at 100
     and finds the groups, but does not try to unbind any  parti-
     cles.  It  does  remove groups with less than 8 members. The
     output files phys.grp, phys.gtp and phys.ray (-ray) are pro-
     duced.


WARNINGS
     1. Make sure you set fLinkLength to a  reasonable  size  for
     your  simulation.  If  too  small it can take a long time to
     converge and may not give reasonable groups due to the  lim-
     ited  resolution of objects in the simulation. If too large,
     it will  miss  the  smaller  scale  objects  and  may  group
     together  many  smaller  objects to form large associations.
     For example the desired groups could be galaxies  in  a  gas



Stadel Release 1.2  Last change: Jan 18, 1995                   7






SKID(1.2)                     SKID                      SKID(1.2)



     and  dark matter simulation, fLinkLength should reflect this
     fact.

     2. Do not run skid with an nSmooth  of  less  than  64  when
     finding  groups  in  a  dark matter only input file. For gas
     simulations an nSmooth of 32 is acceptable.

     3. The unbinding procedure is O(Ngroup^2), this  means  that
     for very large simulations and specifically situations where
     groups larger than a couple of thousand  members  are  found
     the  unbinding  procedure  could be prohibitive. So far this
     has not been a real problem, even in a 2.1 million  particle
     simulation, however, future versions of skid may need to use
     a  tree  code  for  the  group  pootential  energies.   (The
     friends-of-friends  is actually also O(Ngroup^2) but this is
     not such a big problem)


BUGS
     Please report any!


SEE ALSO
     tipsy(1), smooth(1), fof(1)































Stadel Release 1.2  Last change: Jan 18, 1995                   8



